# Configuring GeFeSLE Server
Your configuration file must be well formed json and be specified via command line parameter a la `./GeFeSLE --config=./config.json`

Any 

``` 
{ "DatabaseSettings": { 
        "DatabaseFile": "/home/tezoatlipoca/bin/gefesle/foo.db"
    },
```
* **DatabaseSettings:DatabaseFile** - absolute or relative path to the SQLite database (`.db`) file; if a nonexistant file is specified it will be created and the database schema applied automatically. 
```
    "ServerSettings": {
        "Bind": "*",
        "Port": 7036,
        "Hostname": "https://lists.awadwatt.com",
        "wwwroot" : "wwwroot",
        "modListName" : "MODERATION",
        "Debugging" : true,
        "RunLevel" : "debug"
    },
```
* ServerSettings:Bind - not currently used (server binds to any IP available)
* **ServerSettings:Port** - the port on which the server will listen for incoming connections; default is `5000`
* **ServerSettings:Hostname** - this is the outward facing address of the server; all links, bookmarks, relative paths are generated using this; also used for the cookie domain. While GeFeSLE doesn't (yet) self service SSL certs, if you put it behind NGINX or something else that does, you should specify it as how it appears on the outside of that. But GeFeSLE itself doesn't really understand this; specifying HTTPS for example doesn't make GeFeSLE look for an SSL cert or listen on port 443. 
* **ServerSettings:wwwroot** - specifies the folder that will be the root of the website. All generated and static files, and user uploads will be contained within this folder. Works with either a relative or absolute path; if the folder in question does not exist it will be created. Default is `<current directory>/wwwroot`; if GeFeSLE is in your path and you run it somewhere else, the results may not be what you intended. _TODO: test relative path; test creation of default wwwroot when running from elsewhere; test when running from system cron or systemd invocation_
* **ServerSettings:modListName** - the name of the List created to hold moderation actions. When a List item is reported, or a suggestion item is submitted to a list, a moderation pseudo item is created in this list (which is created if it does not already exist). Default is `MODERATION`, and a list cannot be created or renamed with this name. The moderation list can only be seen by SuperUsers.
* **ServerSettings:Debugging** - default is TRUE (at least for versions 0.1-1.0), you have to explicitly override it to be off. When true, each page generated by the site has some debugging tools shown at the head of each page. 
* **ServerSettings:RunLevel** - logging level; default is `trace` although GeFeSLE has no inegrated logging service (yet) it just writes to STDOUT and STDERR (so when you run it, be sure to pipe that to a file). The levels are as per the `Microsoft.Extensions.Logging` namespace in .NET:

trace = 0,        << very verbose
debug = 1,        << anything involving comparisons, decision branches or function returns
information = 2,  << anything involving an incoming request or returned result
warning = 3,
error = 4,
critical = 5

_TODO: no this can't be specified on the command line_
_TODO: change the default back to information from trace_

```
    "SiteCustomize": {
        "sitetitle": "** < default site title > **",
        "sitehead": "__samplehead.html",
        "bodyheader": "__samplebodyhead.html",
        "bodyfooter": "__samplefooter.html",
        "owner": "** < default site owner info > **"
    },
```
* **SiteCustomize:sitetitle** - this string gets written to the head of the site's index page.
* **SiteCustomize:sitehead** - if this file exists, whatever is IN it is treated as HTML and is inserted into the `<head></head>` block of every page generated for the site. The sample file, `__samplehead.html` only invokes the default site stylesheet `<link rel="stylesheet" href="/gefesle.default.css">`
* **SiteCustomize:bodyheader** - if this file exists, whatever is IN it is treated as HTML and is inserted into the main body of every list page, after any menu options but before the `<h1>` List Title of the page. 
* **SiteCustomize:bodyfooter** - if this file exists, whatever is IN it is treated as HTML and is inserted into the `<footer>` at the end of every list page just before the "Generated by" and site ownership at the end of the `<body>` tag. 
* **SiteCustomize:owner** - owner of the site, put whatever contact information you like here

For `sitehead`, `bodyheader` and `bodyfooter`, these files should be HTML, but don't need to be complete or well formed HTML by themselves (in fact if they are they will probably break the rest of the page).  GeFeSLE currently does no validation, parsing or sanitization of the contents of these, but in theory any valid HTML, script or link (that one would normally put into those sections of an HTML page) that you want to put in here should be fine. Obviously if you bring in a bunch of JavaScript or ads or whatever, that's on you. 
```
    "API": {
        "apiTokenSecretKey" : "IlikeBIGbuttsandIcannotlie!Youotherbrotherscan'tdeny!WhenagirlwalksinwithanittybittywaistandaroundthinginyourfaceyougetSPRUNG!",
        "apiTokenDuration" : "1.00:00:00"
    },
```
* **API:apiTokenSecretKey** - secret sauce seed used to create JWTokens used by API only clients like the browser plugins
* **API:apiTokenDuration** - specifies how long that token is good for; string value representing time duration in `D.HH:MM:SS`; default is `1.00:00:00` (1 day).  _The browser session cookies are currently hardcoded to 30m_
```
    "OtherSites": {
        "Google": {
            "googleClientID" : "************",
            "googleClientSecret" : "************"
        },
        "Microsoft": {
            "microsoftClientId" : "************",
            "microsoftClientSecret" : "************",
            "microsoftTenantId" : "************"
        },
        "Mastodon": {
            "mastoClient_Name" : "GeFeSLE",
            "mastoScopes" : "read write:bookmarks"
        }

    },
```
These are the secret keys that let GeFeSLE use OAuth login and to obtain api tokens on the OAuth user's behalf to access those services on their behalf. [See this page over here for Google and Microsoft instructions on how obtain these](google.microsoft.oauth.md)  For Mastodon it's a bit simpler (? for you anyway) as your GeFeSLE instance needs to register as an application on each _instance_ it wants to allow OAuth and import from. 
* **OtherSites:Mastodon:mastoClient_Name** - This is the name of the service that is requesting OAuth permission from the Mastodon instance. You should change this to be something uniquely identifying, ideally `lists.yourdomain`.
_NOTE: there IS a website that is passed along with instance app registrations but its hardcoded **FIX**_
```
    "Users": {
        "backdooradmin": {
            "username": "<username>",
            "password": "<password>",
            "role": "SuperUser"
        }
    }
}
```
_TODO: role is ignored_
_TODO: other users are ignored_
This provides a hardcoded backdoor account to use in liu of users managed via the nascent user management facilities. This user can always log in, and always has full permissions on anything and everything (role is ignored). In future, this mechanism may be used to prepopulate new instance databases with users. 
